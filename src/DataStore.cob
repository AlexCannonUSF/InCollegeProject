>>SOURCE FORMAT FREE
IDENTIFICATION DIVISION.
PROGRAM-ID. DataStore.

DATA DIVISION.
WORKING-STORAGE SECTION.
77 WS-SLOT-INDEX PIC 9(2) VALUE 1.
77 WS-HIT-END PIC X VALUE "N".

01 ACCT-LINE.
   05 ACCT-LINE-USERNAME PIC X(10).
   05 ACCT-LINE-PASSWORD PIC X(20).

FILE SECTION.
FD ACCT-FILE.
01 ACCT-REC PIC X(30).

LINKAGE SECTION.
01 LK-STORED.
   05 LK-STORED-USERNAME PIC X(10) OCCURS 10 TIMES.
   05 LK-STORED-PASSWORD PIC X(20) OCCURS 10 TIMES.
01 LK-STORED-COUNT PIC 9(2).
01 LK-USERNAME PIC X(10).
01 LK-PASSWORD PIC X(20).
01 LK-OK PIC X.

PROCEDURE DIVISION USING LK-STORED LK-STORED-COUNT LK-USERNAME LK-PASSWORD LK-OK.
MAIN.
    MOVE "Y" TO LK-OK
    MOVE 1 TO WS-SLOT-INDEX

    PERFORM VARYING WS-SLOT-INDEX FROM 1 BY 1 UNTIL WS-SLOT-INDEX > LK-STORED-COUNT
        IF LK-STORED-USERNAME(WS-SLOT-INDEX) = LK-USERNAME
            MOVE "N" TO LK-OK
            EXIT PERFORM
        END-IF
    END-PERFORM

    GOBACK.