>>SOURCE FORMAT FREE
IDENTIFICATION DIVISION.
PROGRAM-ID. LogIn.

DATA DIVISION.
WORKING-STORAGE SECTION.

77 WS-INPUT-USERNAME PIC X(30) VALUE SPACES.
77 WS-INPUT-PASSWORD PIC X(12) VALUE SPACES.
77 WS-SCAN-INDEX PIC 9 VALUE 0.
77 WS-CREDS-MATCHED PIC X VALUE "N".
LINKAGE SECTION.
77 LK-STORED-COUNT PIC 9.
77 LK-LOGIN-SUCCESS PIC X.
01 LK-CREDENTIALS-LIST.
05 LK-CREDS-ROW OCCURS 5 TIMES.
10 LK-STORED-USERNAME PIC X(30).
10 LK-STORED-PASSWORD PIC X(12).
PROCEDURE DIVISION USING LK-STORED-COUNT LK-CREDENTIALS-LIST LK-LOGIN-SUCCESS.

LOGIN-FLOW.
    MOVE "N" TO LK-LOGIN-SUCCESS
    DISPLAY "Enter username: "
    ACCEPT WS-INPUT-USERNAME
    DISPLAY WS-INPUT-USERNAME
    DISPLAY "Enter password: "
    ACCEPT WS-INPUT-PASSWORD
    DISPLAY WS-INPUT-PASSWORD
    PERFORM FIND-MATCHING-CREDS
    IF WS-CREDS-MATCHED = "Y"
        DISPLAY "You have successfully logged in"
        MOVE "Y" TO LK-LOGIN-SUCCESS
        CALL "HomePage" USING WS-INPUT-USERNAME
    ELSE
        DISPLAY "Incorrect username/password, please try again"
        MOVE "N" TO LK-LOGIN-SUCCESS
    END-IF
    GOBACK.

FIND-MATCHING-CREDS.
    MOVE "N" TO WS-CREDS-MATCHED
    IF LK-STORED-COUNT = 0
        EXIT PARAGRAPH
    END-IF
    PERFORM VARYING WS-SCAN-INDEX FROM 1 BY 1 UNTIL WS-SCAN-INDEX > LK-STORED-COUNT
        IF FUNCTION TRIM(LK-STORED-USERNAME(WS-SCAN-INDEX)) = FUNCTION TRIM(WS-INPUT-USERNAME)
           AND FUNCTION TRIM(LK-STORED-PASSWORD(WS-SCAN-INDEX)) = FUNCTION TRIM(WS-INPUT-PASSWORD)
            MOVE "Y" TO WS-CREDS-MATCHED
            EXIT PERFORM
        END-IF
    END-PERFORM.