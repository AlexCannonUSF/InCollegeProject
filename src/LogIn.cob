>>SOURCE FORMAT FREE
IDENTIFICATION DIVISION.
PROGRAM-ID. LogIn.

DATA DIVISION.
WORKING-STORAGE SECTION.
77 WS-INPUT-USERNAME PIC X(10) VALUE SPACES.
77 WS-INPUT-PASSWORD PIC X(20) VALUE SPACES.
77 WS-SCAN-INDEX PIC 9(2) VALUE 1.
77 WS-CREDS-MATCHED PIC X VALUE "N".

LINKAGE SECTION.
01 LK-STORED.
   05 LK-STORED-USERNAME PIC X(10) OCCURS 10 TIMES.
   05 LK-STORED-PASSWORD PIC X(20) OCCURS 10 TIMES.
01 LK-STORED-COUNT PIC 9(2).
01 LNK-USER-NAME PIC X(10).
01 LK-LOGIN-SUCCESS PIC X.

PROCEDURE DIVISION USING LK-STORED LK-STORED-COUNT LNK-USER-NAME LK-LOGIN-SUCCESS.
LOGIN-FLOW.
    DISPLAY "Enter your username: "
    ACCEPT WS-INPUT-USERNAME
    DISPLAY "Enter your password: "
    ACCEPT WS-INPUT-PASSWORD

    MOVE "N" TO WS-CREDS-MATCHED
    PERFORM VARYING WS-SCAN-INDEX FROM 1 BY 1 UNTIL WS-SCAN-INDEX > LK-STORED-COUNT
        IF LK-STORED-USERNAME(WS-SCAN-INDEX) = WS-INPUT-USERNAME
            IF LK-STORED-PASSWORD(WS-SCAN-INDEX) = WS-INPUT-PASSWORD
                MOVE "Y" TO WS-CREDS-MATCHED
                MOVE WS-INPUT-USERNAME TO LNK-USER-NAME
                EXIT PERFORM
            END-IF
        END-IF
    END-PERFORM

    IF WS-CREDS-MATCHED = "Y"
        DISPLAY "You have successfully logged in."
        MOVE "Y" TO LK-LOGIN-SUCCESS
    ELSE
        DISPLAY "Incorrect username/password, please try again."
        MOVE "N" TO LK-LOGIN-SUCCESS
    END-IF

    GOBACK.